# 更新日志

## [未发布] - 2025-10-25

### 新增功能
- **单元测试框架**: 建立完整的JUnit 5测试基础设施
  - 57个单元测试覆盖核心类
  - WeaponRegistry: 14个测试，~90%覆盖率
  - WeaponDefinition: 14个测试，~85%覆盖率
  - MatchPlayerService: 10个测试，~30%覆盖率（受Minecraft依赖限制）
  - VirtualMoneyManager: 3个测试，~20%覆盖率（受Minecraft依赖限制）

### 改进
- **测试文档**: 
  - 创建详细的测试指南（`src/test/java/README.md`）
  - 更新主测试文档（`TESTING.md`）
  - 添加测试最佳实践和示例
- **代码质量**:
  - 为MatchPlayerService添加参数验证测试
  - 遵循AAA测试模式
  - 使用中文DisplayName提高可读性
- **重构计划**:
  - 更新测试完成状态
  - 标记已完成和待完成任务
  - 添加测试覆盖率统计

### 技术改进
- 采用手动Mock实现，避免Mockito依赖问题
- 测试聚焦于可在标准Java环境验证的逻辑
- 详细记录Minecraft依赖限制和集成测试需求

### 文档更新
- 更新架构文档（`docs/ARCHITECTURE.md`）
- 更新重构计划（`docs/REFACTORING_PLAN.md`）
- 完善测试指南和覆盖率信息

## [未发布] - 2024年

### 新增功能
- **观战系统优化**: 死亡玩家自动切换为观战模式，并隐藏身形以防止战术信息泄露
- **流畅视角切换**: 优化观战系统，减少不必要的视角切换，提升观看体验
- **C4掉落提示优化**: 移除坐标显示，仅保留距离信息，避免战术泄露

### 改进
- **命令系统优化**: 
  - 移除 `/cs balance` 命令，余额信息已集成到商店界面中
  - 限制 `/cs watch` 命令，游戏中的玩家无法切换观战视角
- **事件处理增强**:
  - 为玩家死亡事件添加异常捕获和详细日志记录
  - 优化事件处理机制，避免内存泄漏
- **用户体验提升**:
  - 优化观战者视角更新逻辑，只在必要时切换
  - 回合开始时自动恢复玩家可见性

### 文档更新
- 更新 README.md，反映最新功能变化
- 更新玩家操作说明，移除已废弃的命令
- 添加观战系统和C4系统的详细说明
- 更新开发计划列表

### 技术改进
- 增强错误处理机制
- 添加详细的操作日志记录
- 优化代码注释和文档

## [1.0.0] - 初始版本

### 核心功能
- 完整的5v5竞技模式
- 虚拟货币经济系统
- GUI商店系统
- C4炸弹机制
- 回合制游戏流程
- 半场换边系统
- 实时计分板
- 基础观战系统

### 支持的功能
- 比赛创建和管理
- 玩家加入和踢出
- 出生点和包点设置
- 预设系统
- 配置文件支持
